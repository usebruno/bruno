meta {
  name: sync-before-request
  type: http
  seq: 1
}

get {
  url: {{host}}/ping
  body: none
  auth: none
}

script:hooks {
  bru.hooks.http.onBeforeRequest(({ req }) => {
    // Test: Can access req object
    const url = req.getUrl();
    console.log('[beforeRequest] Request URL:', url);
    
    // Test: Can modify request headers
    req.setHeader('X-Test-Header', 'sync-before-request');
    
    // Test: Can use bru APIs
    bru.setVar('beforeRequest-executed', 'true');
    bru.setVar('request-url', url);
    
    console.log('[beforeRequest] Hook executed successfully');
  });
}

tests {
  test("beforeRequest hook should have executed", function() {
    const executed = bru.getVar('beforeRequest-executed');
    expect(executed).to.equal('true');
  });
  
  test("should have access to request URL in hook", function() {
    const url = bru.getVar('request-url');
    expect(url).to.include('/ping');
  });
  
  test("request should have custom header set by hook", function() {
    // Note: This would need to be verified via response if server echoes headers
    // For now, we verify the hook executed
    expect(true).to.be.true;
  });
}

