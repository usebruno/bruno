meta {
  name: request
  type: http
  seq: 1
}

post {
  url: https://echo.usebruno.com
  body: none
  auth: inherit
}

tests {
  await test("urlencoded body mode with urlencoded content-type", async () => {
    await bru.sendRequest({
      url: "https://echo.usebruno.com",
      method: "POST",
      header: {
        'Content-Type': 'application/x-www-form-urlencoded',
      },
      body: {
        mode: "urlencoded",
        urlencoded: [
          { key: "client_id", value: "client_id_value" },
          { key: "client_secret", value: "client_secret_value" }
        ]
      }
    }, (error, response) => {
      expect(response?.data).to.contain("client_id");
      expect(response?.data).to.contain("client_id_value");
      expect(response?.data).to.contain("client_secret");
      expect(response?.data).to.contain("client_secret_value");
      expect(response?.data).to.eql("client_id=client_id_value&client_secret=client_secret_value");
    });
  });
  
  
  await test("urlencoded body mode", async () => {
    await bru.sendRequest({
      url: "https://echo.usebruno.com",
      method: "POST",
      body: {
        mode: "urlencoded",
        urlencoded: [
          { key: "client_id", value: "client_id_value" },
          { key: "client_secret", value: "client_secret_value" }
        ]
      }
    }, (error, response) => {
      expect(response?.data).to.contain("client_id");
      expect(response?.data).to.contain("client_id_value");
      expect(response?.data).to.contain("client_secret");
      expect(response?.data).to.contain("client_secret_value");
      expect(response?.data).to.eql("client_id=client_id_value&client_secret=client_secret_value");
    });
  });
}
