meta {
  name: deleteAllEnvVars
  type: http
  seq: 23
}

get {
  url: {{host}}/ping
  body: none
  auth: none
}

script:pre-request {
  bru.setEnvVar("testDelAllEnvVar", "to-be-deleted");
}

tests {
  const savedEnvVars = bru.getAllEnvVars();
  bru.deleteAllEnvVars();

  test("should delete all env vars", function() {
    const val = bru.getEnvVar("testDelAllEnvVar");
    expect(val).to.be.undefined;
  });

  test("should preserve env name after deleting all vars", function() {
    const envName = bru.getEnvName();
    expect(envName).to.equal("Prod");
  });

  // Restore env vars for subsequent requests
  for (const [key, value] of Object.entries(savedEnvVars)) {
    bru.setEnvVar(key, value);
  }
}
